<?xml version="1.0" ?>

<gprconfig>
  <configuration>
    <config><![CDATA[

   SH_Precision_Mode := external ("KOS_SH4_PRECISION", "-m4-single-only");
   KOS_Base := external ("KOS_BASE");

   package Compiler is
      
      Common_Required_Switches := (
        --  External_As_List ("BARE_RUNTIME_SWITCHES", " ");
        "-fomit-frame-pointer",
        "-ml",
        "-matomic-model=soft-imask",
        "-ftls-model=local-exec",
        SH_Precision_Mode
      );

      for Leading_Required_Switches ("Ada") use
         Compiler'Leading_Required_Switches ("Ada") &
         Common_Required_Switches;
      for Leading_Required_Switches ("C") use
         Compiler'Leading_Required_Switches ("C") &
         Common_Required_Switches &
         ("-fno-builtin", "-D_arch_dreamcast",
          "-D_arch_sub_pristine");
      for Leading_Required_Switches ("C++") use
         Compiler'Leading_Required_Switches ("C") &
         Common_Required_Switches &
         ("-fno-builtin", "-D_arch_dreamcast",
          "-D_arch_sub_pristine");
      for Leading_Required_Switches ("Asm") use
         Compiler'Leading_Required_Switches ("Asm") &
         Common_Required_Switches;
      for Leading_Required_Switches ("Asm2") use
         Compiler'Leading_Required_Switches ("Asm2") &
         Common_Required_Switches;
      for Leading_Required_Switches ("Asm_Cpp") use
         Compiler'Leading_Required_Switches ("Asm_Cpp") &
         Common_Required_Switches;
   end Compiler;

   package Linker is
      for Required_Switches use Linker'Required_Switches &
        ("-Wl,-Ttext=0x8c010000",
         "-nodefaultlibs",
         "-T" & KOS_Base & "/utils/ldscripts/shlelf.xc") &
        ("-Wl,-L${RUNTIME_DIR(Ada)}/adalib") &
         Compiler.Common_Required_Switches &
         ("-lkosutils",
          "-Wl,--start-group",
            "-lkallisti",
            "-lc",
            "-lgcc",
          "-Wl,--end-group");
   end Linker;
]]>
   </config>
  </configuration>
</gprconfig>
